/*! jquery.jelect.js v1.0.0 | felixexter | MIT License | https://github.com/CSSSR/jelect/ */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){"use strict";var t,i,o,n="jelect";e[n]={version:"1.0.0",options:{classes:{autocomplete:n+"_type_autocomplete",containerActive:n+"_state_active",containerDisabled:n+"_state_disabled",currentActive:n+"-current_state_active",optionsActive:n+"-options_state_active",optionActive:n+"-option_state_active",optionDisabled:n+"-option_state_disabled",optionHide:n+"-option_state_hide"},plugins:[]},plugins:{},selectors:{container:".js-"+n,scroller:".js-"+n+"-scroller",input:".js-"+n+"-input",current:".js-"+n+"-current",options:".js-"+n+"-options",option:".js-"+n+"-option",optionValue:".js-"+n+"-option-value"},keyCode:{TAB:9,BACKSPACE:8,ENTER:13,ESC:27,DOWN:40,UP:38,HOME:36,END:35,PAGE_UP:33,PAGE_DOWN:34}},i=function(t){var i=this,o=e[n],s=o.selectors,a=o.options.classes,r=i.$jelectOptions.find(s.option+'[data-val="'+t+'"]'),l=r.find(s.optionValue).text();return r.hasClass(a.optionDisabled)?(console.error("Option {"+t+"} is disabled"),!1):(r.addClass(a.optionActive).siblings(s.option).removeClass(a.optionActive),i.$jelect.removeClass(a.containerActive).trigger("jelect.change"),i.autocomplete?i.$jelectCurrent.val(t):(i.$jelectCurrent.text(l).attr("data-val",t),i.$jelectInput.val(t).attr("value",t).trigger("change")),void i.trigger("change"))},o=function(){var t=this,i=e[n].selectors,o=[];return t.$jelectOptions.find(i.option).each(function(t,i){var n=e(i);o.push({index:t,value:n.data("val")})}),o},t=function(t,i){var o=e[n],s=o.selectors,a=o.options.classes,r={$jelect:t,$jelectCurrent:t.find(s.current),$jelectOptions:t.find(s.options),$jelectInput:t.find(s.input),autocomplete:t.hasClass(a.autocomplete),options:e.extend(!0,{},o.options,i||{})};e.extend(!0,this,r),this.init()},t.prototype.init=function(){var t=this,o=e[n],s=o.selectors,a=t.options.classes,r=t.val();t.trigger("init"),t.values=t.serialize(),t.$jelect.val(r),t.$jelectCurrent.on("click "+n+".clickCurrent",function(){var i=e(s.container).filter("."+a.containerActive).not(t.$jelect),o=e(s.options).filter("."+a.optionsActive).not(t.$jelectOptions),n=t.$jelect.hasClass(a.containerDisabled),r=!t.$jelect.hasClass(a.containerActive)&&!t.$jelectOptions.hasClass(a.optionsActive);return n?!1:(r&&t.trigger("beforeOpen"),i.length&&o.length&&(i.removeClass(a.containerActive),o.removeClass(a.optionsActive)),t.$jelect.toggleClass(a.containerActive),t.$jelectOptions.toggleClass(a.optionsActive),t.autocomplete&&t.$jelectCurrent.trigger("keyup"),void(r&&(t.$jelectCurrent.trigger("focus"),t.trigger("afterOpen"))))}),t.$jelectOptions.on("click "+n+".changeOption",s.option,function(){var o=e(this),n=o.data("val");return o.hasClass(a.optionDisabled)?!1:(i.call(t,n),void t.$jelectOptions.removeClass(a.optionsActive))}),t.autocomplete&&t.$jelectCurrent.on("keyup",function(i){var n=e(this),r=o.keyCode,l=i.keyCode,c=String.fromCharCode(l),p=/[a-zA-Zа-яА-ЯЁё0-9]/,u=n.val(),v=t.$jelectOptions.find(s.option),d=t.$jelect.find(s.scroller),f=e.grep(t.values,function(e){return-1===e.value.indexOf(u)});(p.test(c)||l===r.BACKSPACE)&&(t.$jelect.hasClass(a.containerActive)||t.$jelectCurrent.trigger("click"),v.removeClass(a.optionHide),e.each(f,function(e,t){var i=t.value;v.filter('[data-val="'+i+'"]').addClass(a.optionHide)}),v.filter(":visible").removeClass(a.optionActive).first().addClass(a.optionActive),d.scrollTop(0))})},t.prototype.trigger=function(t){var i=this;e.each(i.options.plugins||[],function(o,s){s=e[n].plugins[s],s&&s[t]&&s[t]({$jelect:i.$jelect,$jelectCurrent:i.$jelectCurrent,$jelectOptions:i.$jelectOptions,$jelectInput:i.$jelectInput,options:i.options,text:i.text(),val:i.val()})})},t.prototype.text=function(){return this.$jelectCurrent.text().trim()},t.prototype.val=function(){return this.$jelect.val()},t.prototype.setValue=function(e){return"undefined"!=typeof e&&i.call(this,e),this},t.prototype.serialize=function(){return o.call(this)},t.prototype.disable=function(t){var i=this,o=e[n],s=o.selectors,a=o.options.classes,r=i.$jelectOptions.find(s.option+'[data-val="'+t+'"]'),l=!r.hasClass(a.optionDisabled);if("undefined"!=typeof t){if(l&&(r.addClass(a.optionDisabled),i.$jelectCurrent.data("val")===t)){var c=i.$jelectOptions.find(s.option).not("."+a.optionDisabled).first();i.setValue(c.data("val"))}}else i.$jelect.addClass(a.containerDisabled),i.$jelectInput.attr("disabled",!0);return this},t.prototype.enable=function(t){var i=this,o=e[n],s=o.selectors,a=o.options.classes,r=i.$jelectOptions.find(s.option+'[data-val="'+t+'"]'),l=r.hasClass(a.optionDisabled);return"undefined"!=typeof t&&l?l&&(r=i.$jelectOptions.find(s.option+'[data-val="'+t+'"]'),r.removeClass(a.optionDisabled)):(i.$jelect.removeClass(a.containerDisabled),i.$jelectInput.attr("disabled",!1)),this},e(window.document).on("click "+n+".clickOutside",function(t){var i,o,s=e[n],a=s.selectors,r=e(t.target),l=e(a.options);if(!r.is(a.container)&&!r.closest(a.container).length){if(i=l.closest(a.container).data("jelect"),!i)return;o=i.options.classes,l.hasClass(o.optionsActive)&&(l.removeClass(o.optionsActive).closest(a.container).removeClass(o.containerActive),i.trigger("clickOutside"))}}).on("keydown "+n+".keydown",function(t){var i,o,s,a,r,l,c,p,u,v,d,f,C,g,j,h=e(t.target),A=e[n],$=A.keyCode,b=t.keyCode,y=A.selectors;if(h.is(y.current)){switch(i=h.closest(y.container).data(n),o=i.options.classes,v=h.closest(y.container),d=v.find(y.scroller),f=v.find(y.options),r=f.outerHeight(),C=v.find(y.option).not("."+o.optionHide),g=C.filter("."+o.optionActive),l=v.hasClass(o.containerActive),s=d.scrollTop(),b){case $.TAB:v.removeClass(o.containerActive),f.removeClass(o.optionsActive);break;case $.ENTER:v.hasClass(o.containerActive)?g.trigger(n+".changeOption"):h.trigger("click"),t.preventDefault();break;case $.ESC:if(!l)return;C.length&&h.trigger(n+".clickCurrent"),h.trigger("click");break;case $.UP:if(t.preventDefault(),!l)return;var m=C.first().is(g);g.removeClass(o.optionActive),j=m?C.last():g.prevAll(":visible").not("."+o.optionDisabled).first(),a=j.position().top,0>a?s+=a:a>s+r&&(s=a);break;case $.DOWN:if(t.preventDefault(),!l)return;var D=C.last().is(g);g.removeClass(o.optionActive),j=D?C.first():g.nextAll(":visible").not("."+o.optionDisabled).first(),a=j.position().top,a>=r?s+=a:0>a&&(s=a);break;case $.HOME:if(t.preventDefault(),!l)return;if(g.is(C.first()))return;g.removeClass(o.optionActive),j=C.first(),s=j.position().top;break;case $.END:if(t.preventDefault(),!l)return;if(g.is(C.last()))return;g.removeClass(o.optionActive),j=C.last(),s=j.position().top;break;case $.PAGE_UP:if(t.preventDefault(),!l)return;c=Math.round(r/g.outerHeight()),p=Math.ceil((g.index()+1)/c)-1,u=p*c-c-1,g.removeClass(o.optionActive),0>u&&(u=0),j=0===u&&C.eq(u).hasClass(o.optionDisabled)?C.eq(u).nextAll(":visible").not("."+o.optionDisabled).first():C.eq(u),s+=j.position().top;break;case $.PAGE_DOWN:if(t.preventDefault(),!l)return;c=Math.round(r/g.outerHeight()),p=Math.ceil((g.index()+1)/c)+1,u=p*c-c,g.removeClass(o.optionActive),u>C.length&&(u=C.length-1),j=u===C.length-1?C.eq(u):C.eq(u).nextAll(":visible").not("."+o.optionDisabled).first(),s+=j.position().top}j&&(j.addClass(o.optionActive),d.scrollTop(s))}else h.is(y.option)&&(i=h.closest(y.container).data(n),o=i.options.classes,b===$.ENTER&&h.trigger(n+".changeOption"))}),e.fn[n]=function(i){var o=this,s=arguments;if(void 0===i||"object"==typeof i)return o.each(function(o,s){e.data(s,n)||e.data(s,n,new t(e(s),i))});if("string"==typeof i&&"_"!==i[0]&&"init"!==i){var a;return o.each(function(o,r){var l=e.data(r,n);l instanceof t&&"function"==typeof l[i]&&(a=l[i].apply(l,Array.prototype.slice.call(s,1))),"destroy"===i&&e.data(this,n,null)}),void 0!==a?a:o}}});