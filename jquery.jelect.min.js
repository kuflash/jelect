/*! jquery.jelect.js v1.0.0 | felixexter | MIT License | https://github.com/CSSSR/jelect/ */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";var e,o,i,n="jelect";t[n]={version:"1.0.0",options:{classes:{autocomplete:n+"_type_autocomplete",containerActive:n+"_state_active",containerDisabled:n+"_state_disabled",currentActive:n+"-current_state_active",optionsActive:n+"-options_state_active",optionActive:n+"-option_state_active",optionDisabled:n+"-option_state_disabled",optionHide:n+"-option_state_hide"},plugins:[]},plugins:{},selectors:{container:".js-"+n,scroller:".js-"+n+"-scroller",input:".js-"+n+"-input",current:".js-"+n+"-current",options:".js-"+n+"-options",option:".js-"+n+"-option",optionValue:".js-"+n+"-option-value"},keyCode:{BACKSPACE:8,ENTER:13,ESC:27,DOWN:40,UP:38,HOME:36,END:35}},o=function(e){var o=this,i=t[n],s=i.selectors,a=i.options.classes,r=o.$jelectOptions.find(s.option+'[data-val="'+e+'"]'),l=r.find(s.optionValue).text();return r.hasClass(a.optionDisabled)?(console.error("Option {"+e+"} is disabled"),!1):(r.addClass(a.optionActive).siblings(s.option).removeClass(a.optionActive),o.$jelect.val(e).removeClass(a.containerActive).trigger("jelect.change"),o.autocomplete?o.$jelectCurrent.val(e):(o.$jelectCurrent.text(l).attr("data-val",e),o.$jelectInput.val(e).trigger("change")),void o.trigger("change"))},i=function(){var e=this,o=t[n].selectors,i=[];return e.$jelectOptions.find(o.option).each(function(e,o){var n=t(o);i.push({index:e,value:n.data("val")})}),i},e=function(e,o){var i=t[n],s=i.selectors,a=i.options.classes,r={$jelect:e,$jelectCurrent:e.find(s.current),$jelectOptions:e.find(s.options),$jelectInput:e.find(s.input),autocomplete:e.hasClass(a.autocomplete),options:t.extend(!0,{},i.options,o||{})};t.extend(!0,this,r),this.init()},e.prototype.init=function(){var e=this,i=t[n],s=i.selectors,a=e.options.classes,r=e.val();e.trigger("init"),e.values=e.serialize(),e.$jelect.val(r),e.$jelectCurrent.on("click "+n+".clickCurrent",function(){var o=t(s.container).filter("."+a.containerActive).not(e.$jelect),i=t(s.options).filter("."+a.optionsActive).not(e.$jelectOptions),n=e.$jelect.hasClass(a.containerDisabled),r=!e.$jelect.hasClass(a.containerActive)&&!e.$jelectOptions.hasClass(a.optionsActive);return n?!1:(r&&e.trigger("beforeOpen"),o.length&&i.length&&(o.removeClass(a.containerActive),i.removeClass(a.optionsActive)),e.$jelect.toggleClass(a.containerActive),e.$jelectOptions.toggleClass(a.optionsActive),e.autocomplete&&e.$jelectCurrent.trigger("keyup"),void(r&&(e.$jelectCurrent.trigger("focus"),e.trigger("afterOpen"))))}),e.$jelectOptions.on("click "+n+".changeOption",s.option,function(){var i=t(this),n=i.data("val");return i.hasClass(a.optionDisabled)?!1:(o.call(e,n),void e.$jelectOptions.removeClass(a.optionsActive))}),e.autocomplete&&e.$jelectCurrent.on("keyup",function(o){var n=t(this),r=i.keyCode,l=o.keyCode,c=String.fromCharCode(l),p=/[a-zA-Zа-яА-ЯЁё0-9]/,u=n.val(),v=e.$jelectOptions.find(s.option),d=e.$jelect.find(s.scroller),f=t.grep(e.values,function(t){return-1===t.value.indexOf(u)});(p.test(c)||l===r.BACKSPACE)&&(e.$jelect.hasClass(a.containerActive)||e.$jelectCurrent.trigger("click"),v.removeClass(a.optionHide),t.each(f,function(t,e){var o=e.value;v.filter('[data-val="'+o+'"]').addClass(a.optionHide)}),v.filter(":visible").removeClass(a.optionActive).first().addClass(a.optionActive),d.scrollTop(0))})},e.prototype.trigger=function(e){var o=this;t.each(o.options.plugins||[],function(i,s){s=t[n].plugins[s],s&&s[e]&&s[e]({$jelect:o.$jelect,$jelectCurrent:o.$jelectCurrent,$jelectOptions:o.$jelectOptions,$jelectInput:o.$jelectInput,options:o.options,text:o.text(),val:o.val()})})},e.prototype.text=function(){return this.$jelectCurrent.text().trim()},e.prototype.val=function(){return this.$jelect.val()},e.prototype.setValue=function(t){return"undefined"!=typeof t&&o.call(this,t),this},e.prototype.serialize=function(){return i.call(this)},e.prototype.disable=function(e){var o=this,i=t[n],s=i.selectors,a=i.options.classes,r=o.$jelectOptions.find(s.option+'[data-val="'+e+'"]'),l=!r.hasClass(a.optionDisabled);if("undefined"!=typeof e){if(l&&(r.addClass(a.optionDisabled),o.$jelectCurrent.data("val")===e)){var c=o.$jelectOptions.find(s.option).not("."+a.optionDisabled).first();o.setValue(c.data("val"))}}else o.$jelect.addClass(a.containerDisabled),o.$jelectInput.attr("disabled",!0);return this},e.prototype.enable=function(e){var o=this,i=t[n],s=i.selectors,a=i.options.classes,r=o.$jelectOptions.find(s.option+'[data-val="'+e+'"]'),l=r.hasClass(a.optionDisabled);return"undefined"!=typeof e&&l?l&&(r=o.$jelectOptions.find(s.option+'[data-val="'+e+'"]'),r.removeClass(a.optionDisabled)):(o.$jelect.removeClass(a.containerDisabled),o.$jelectInput.attr("disabled",!1)),this},t(window.document).on("click "+n+".clickOutside",function(e){var o,i,s=t[n],a=s.selectors,r=t(e.target),l=t(a.options);if(!r.is(a.container)&&!r.closest(a.container).length){if(o=l.closest(a.container).data("jelect"),!o)return;i=o.options.classes,l.hasClass(i.optionsActive)&&(l.removeClass(i.optionsActive).closest(a.container).removeClass(i.containerActive),o.trigger("clickOutside"))}}).on("keydown "+n+".keydown",function(e){var o,i,s,a,r,l,c,p,u,v,d,f,j=t(e.target),C=t[n],g=C.keyCode,h=e.keyCode,$=C.selectors;if(j.is($.current)){if(o=j.closest($.container).data(n),i=o.options.classes,c=j.closest($.container),p=c.find($.scroller),u=c.find($.options),r=u.outerHeight(),v=c.find($.option).not("."+i.optionHide),d=v.filter("."+i.optionActive),l=c.hasClass(i.containerActive),!l)return;switch(s=p.scrollTop(),h){case g.ENTER:d.trigger(n+".changeOption"),e.preventDefault();break;case g.ESC:v.length&&j.trigger(n+".clickCurrent"),j.trigger("blur");break;case g.UP:e.preventDefault();var A=v.first().is(d);d.removeClass(i.optionActive),f=A?v.last():d.prevAll(":visible").first(),a=f.position().top,0>a?s+=a:a>s+r&&(s=a);break;case g.DOWN:e.preventDefault();var y=v.last().is(d);d.removeClass(i.optionActive),f=y?v.first():d.nextAll(":visible").first(),a=f.position().top,a>=r?s+=f.outerHeight():0>a&&(s=a);break;case g.HOME:e.preventDefault(),d.removeClass(i.optionActive),f=v.first(),s=f.position().top;break;case g.END:e.preventDefault(),d.removeClass(i.optionActive),f=v.last(),s=f.position().top}f&&(f.addClass(i.optionActive),p.scrollTop(s))}else j.is($.option)&&(o=j.closest($.container).data(n),i=o.options.classes,h===g.ENTER&&j.trigger(n+".changeOption"))}),t.fn[n]=function(o){var i=this,s=arguments;if(void 0===o||"object"==typeof o)return i.each(function(i,s){t.data(s,n)||t.data(s,n,new e(t(s),o))});if("string"==typeof o&&"_"!==o[0]&&"init"!==o){var a;return i.each(function(i,r){var l=t.data(r,n);l instanceof e&&"function"==typeof l[o]&&(a=l[o].apply(l,Array.prototype.slice.call(s,1))),"destroy"===o&&t.data(this,n,null)}),void 0!==a?a:i}}});