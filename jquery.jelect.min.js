/*! jquery.jelect.js v1.0.0 | felixexter | MIT License | https://github.com/CSSSR/jelect/ */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){"use strict";var t,o,i,n="jelect";e[n]={version:"1.0.0",options:{classes:{autocomplete:n+"_type_autocomplete",containerActive:n+"_state_active",containerDisabled:n+"_state_disabled",currentActive:n+"-current_state_active",optionsActive:n+"-options_state_active",optionActive:n+"-option_state_active",optionDisabled:n+"-option_state_disabled",optionHide:n+"-option_state_hide"},plugins:[]},plugins:{},selectors:{container:".js-"+n,scroller:".js-"+n+"-scroller",input:".js-"+n+"-input",current:".js-"+n+"-current",options:".js-"+n+"-options",option:".js-"+n+"-option",optionValue:".js-"+n+"-option-value"},keyCode:{BACKSPACE:8,ENTER:13,ESC:27,DOWN:40,UP:38,HOME:36,END:35,PAGE_UP:33,PAGE_DOWN:34}},o=function(t){var o=this,i=e[n],s=i.selectors,a=i.options.classes,r=o.$jelectOptions.find(s.option+'[data-val="'+t+'"]'),l=r.find(s.optionValue).text();return r.hasClass(a.optionDisabled)?(console.error("Option {"+t+"} is disabled"),!1):(r.addClass(a.optionActive).siblings(s.option).removeClass(a.optionActive),o.$jelect.val(t).removeClass(a.containerActive).trigger("jelect.change"),o.autocomplete?o.$jelectCurrent.val(t):(o.$jelectCurrent.text(l).attr("data-val",t),o.$jelectInput.val(t).trigger("change")),void o.trigger("change"))},i=function(){var t=this,o=e[n].selectors,i=[];return t.$jelectOptions.find(o.option).each(function(t,o){var n=e(o);i.push({index:t,value:n.data("val")})}),i},t=function(t,o){var i=e[n],s=i.selectors,a=i.options.classes,r={$jelect:t,$jelectCurrent:t.find(s.current),$jelectOptions:t.find(s.options),$jelectInput:t.find(s.input),autocomplete:t.hasClass(a.autocomplete),options:e.extend(!0,{},i.options,o||{})};e.extend(!0,this,r),this.init()},t.prototype.init=function(){var t=this,i=e[n],s=i.selectors,a=t.options.classes,r=t.val();t.trigger("init"),t.values=t.serialize(),t.$jelect.val(r),t.$jelectCurrent.on("click "+n+".clickCurrent",function(){var o=e(s.container).filter("."+a.containerActive).not(t.$jelect),i=e(s.options).filter("."+a.optionsActive).not(t.$jelectOptions),n=t.$jelect.hasClass(a.containerDisabled),r=!t.$jelect.hasClass(a.containerActive)&&!t.$jelectOptions.hasClass(a.optionsActive);return n?!1:(r&&t.trigger("beforeOpen"),o.length&&i.length&&(o.removeClass(a.containerActive),i.removeClass(a.optionsActive)),t.$jelect.toggleClass(a.containerActive),t.$jelectOptions.toggleClass(a.optionsActive),t.autocomplete&&t.$jelectCurrent.trigger("keyup"),void(r&&(t.$jelectCurrent.trigger("focus"),t.trigger("afterOpen"))))}),t.$jelectOptions.on("click "+n+".changeOption",s.option,function(){var i=e(this),n=i.data("val");return i.hasClass(a.optionDisabled)?!1:(o.call(t,n),void t.$jelectOptions.removeClass(a.optionsActive))}),t.autocomplete&&t.$jelectCurrent.on("keyup",function(o){var n=e(this),r=i.keyCode,l=o.keyCode,c=String.fromCharCode(l),p=/[a-zA-Zа-яА-ЯЁё0-9]/,u=n.val(),v=t.$jelectOptions.find(s.option),d=t.$jelect.find(s.scroller),f=e.grep(t.values,function(e){return-1===e.value.indexOf(u)});(p.test(c)||l===r.BACKSPACE)&&(t.$jelect.hasClass(a.containerActive)||t.$jelectCurrent.trigger("click"),v.removeClass(a.optionHide),e.each(f,function(e,t){var o=t.value;v.filter('[data-val="'+o+'"]').addClass(a.optionHide)}),v.filter(":visible").removeClass(a.optionActive).first().addClass(a.optionActive),d.scrollTop(0))})},t.prototype.trigger=function(t){var o=this;e.each(o.options.plugins||[],function(i,s){s=e[n].plugins[s],s&&s[t]&&s[t]({$jelect:o.$jelect,$jelectCurrent:o.$jelectCurrent,$jelectOptions:o.$jelectOptions,$jelectInput:o.$jelectInput,options:o.options,text:o.text(),val:o.val()})})},t.prototype.text=function(){return this.$jelectCurrent.text().trim()},t.prototype.val=function(){return this.$jelect.val()},t.prototype.setValue=function(e){return"undefined"!=typeof e&&o.call(this,e),this},t.prototype.serialize=function(){return i.call(this)},t.prototype.disable=function(t){var o=this,i=e[n],s=i.selectors,a=i.options.classes,r=o.$jelectOptions.find(s.option+'[data-val="'+t+'"]'),l=!r.hasClass(a.optionDisabled);if("undefined"!=typeof t){if(l&&(r.addClass(a.optionDisabled),o.$jelectCurrent.data("val")===t)){var c=o.$jelectOptions.find(s.option).not("."+a.optionDisabled).first();o.setValue(c.data("val"))}}else o.$jelect.addClass(a.containerDisabled),o.$jelectInput.attr("disabled",!0);return this},t.prototype.enable=function(t){var o=this,i=e[n],s=i.selectors,a=i.options.classes,r=o.$jelectOptions.find(s.option+'[data-val="'+t+'"]'),l=r.hasClass(a.optionDisabled);return"undefined"!=typeof t&&l?l&&(r=o.$jelectOptions.find(s.option+'[data-val="'+t+'"]'),r.removeClass(a.optionDisabled)):(o.$jelect.removeClass(a.containerDisabled),o.$jelectInput.attr("disabled",!1)),this},e(window.document).on("click "+n+".clickOutside",function(t){var o,i,s=e[n],a=s.selectors,r=e(t.target),l=e(a.options);if(!r.is(a.container)&&!r.closest(a.container).length){if(o=l.closest(a.container).data("jelect"),!o)return;i=o.options.classes,l.hasClass(i.optionsActive)&&(l.removeClass(i.optionsActive).closest(a.container).removeClass(i.containerActive),o.trigger("clickOutside"))}}).on("keydown "+n+".keydown",function(t){var o,i,s,a,r,l,c,p,u,v,d,f,C,j,g,h=e(t.target),$=e[n],A=$.keyCode,b=t.keyCode,y=$.selectors;if(h.is(y.current)){if(o=h.closest(y.container).data(n),i=o.options.classes,v=h.closest(y.container),d=v.find(y.scroller),f=v.find(y.options),r=f.outerHeight(),C=v.find(y.option).not("."+i.optionHide),j=C.filter("."+i.optionActive),l=v.hasClass(i.containerActive),!l)return;switch(s=d.scrollTop(),b){case A.ENTER:j.trigger(n+".changeOption"),t.preventDefault();break;case A.ESC:C.length&&h.trigger(n+".clickCurrent"),h.trigger("blur");break;case A.UP:t.preventDefault();var O=C.first().is(j);j.removeClass(i.optionActive),g=O?C.last():j.prevAll(":visible").first(),a=g.position().top,0>a?s+=a:a>s+r&&(s=a);break;case A.DOWN:t.preventDefault();var m=C.last().is(j);j.removeClass(i.optionActive),g=m?C.first():j.nextAll(":visible").first(),a=g.position().top,a>=r?s+=g.outerHeight():0>a&&(s=a);break;case A.HOME:t.preventDefault(),j.removeClass(i.optionActive),g=C.first(),s=g.position().top;break;case A.END:t.preventDefault(),j.removeClass(i.optionActive),g=C.last(),s=g.position().top;break;case A.PAGE_UP:t.preventDefault(),c=Math.round(r/j.outerHeight()),p=Math.ceil((j.index()+1)/c)-1,u=p*c-c+1,j.removeClass(i.optionActive),0>u&&(u=0),g=C.eq(u),s-=r;break;case A.PAGE_DOWN:t.preventDefault(),c=Math.round(r/j.outerHeight()),p=Math.ceil((j.index()+1)/c)+1,u=p*c-c,j.removeClass(i.optionActive),u>C.length&&(u=C.length-1),g=C.eq(u),s+=r}g&&(g.addClass(i.optionActive),d.scrollTop(s))}else h.is(y.option)&&(o=h.closest(y.container).data(n),i=o.options.classes,b===A.ENTER&&h.trigger(n+".changeOption"))}),e.fn[n]=function(o){var i=this,s=arguments;if(void 0===o||"object"==typeof o)return i.each(function(i,s){e.data(s,n)||e.data(s,n,new t(e(s),o))});if("string"==typeof o&&"_"!==o[0]&&"init"!==o){var a;return i.each(function(i,r){var l=e.data(r,n);l instanceof t&&"function"==typeof l[o]&&(a=l[o].apply(l,Array.prototype.slice.call(s,1))),"destroy"===o&&e.data(this,n,null)}),void 0!==a?a:i}}});